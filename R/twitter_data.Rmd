---
title: '@jumping_uk Twitter Analysis'
author: "David Saipe"
date: '2022-07-06'
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(rtweet)
library(dplyr)
library(ggplot2)
library(stringr)
library(lubridate)
```

```{r jr timeline, include = FALSE}
jr_timeline = read.csv("Data/jr_timeline.csv")

jr_timeline = jr_timeline %>%
  filter(is_retweet == FALSE)
jr_timeline = jr_timeline %>%
  select(status_id, created_at, favorite_count, retweet_count, mentions_screen_name, urls_url, hashtags, media_type)
jr_timeline = jr_timeline %>%
  mutate(hour_posted = hour(created_at), interactions = retweet_count + favorite_count)
jr_timeline$status_id = gsub("x", "", as.character(jr_timeline$status_id))
```

```{r time posted, include = FALSE}
avg_interactions = jr_timeline %>%
  group_by(hour_posted) %>%
  summarise(avg_interactions = mean(interactions))

ggplot(avg_interactions, aes(hour_posted, avg_interactions)) +
  geom_col()

```

```{r retweeters, include = FALSE}
retweeters_data = read.csv("Data/retweeters_list.csv")
retweeters_data = retweeters_data %>%
  select(location)
```

```{r hashtags, echo = FALSE}
rstats = read.csv("Data/rstats_hashtag_tweets.csv")

rstats = rstats %>%
  filter(is_retweet == FALSE & is_quote == FALSE)
rstats = rstats %>%
  select(favorite_count, retweet_count, hashtags)
rstats = rstats %>%
  mutate(hashtag_num = str_count(hashtags, "\\w+"))

ggplot(rstats) +
  geom_smooth(aes(hashtag_num, interactions)) +
  xlim(0,25) +
  xlab("Number of hashtags used") + 
  ylab("Number of interactions")
  
```








